# 基于传感器的城市道路状况检测——软件需求说明书

## 1. 引言

### 1.1 编写目的

本文档的编写目的是为基于传感器的城市道路状况检测的开发提供:

1. 软件总体要求,作为用户和软件开发人员之间了解的基础;
2. 功能、性能、接口和可靠性的要求,作为软件人员进行设计和编码的基础;
3. 验收标准,作为用户确认测试的依据。

### 1.3 文档编写约定

#### 1.3.1 优先级定义

必须且优先 完成安卓客户端完成数据采集，数据传送到后端存储  
必须但一般 模型建立与训练，地图坑口热力图可视化展示  
可选且优先 模型预测结构展示  
可选且一般 安卓客户端数据汇聚展示  
本期不考虑 用户积分反馈  

#### 1.3.2 需求编号约定

数据采集模块-摄像头数据的连接与视频传输与处理 R1001
数据采集模块-手机传感器数据采集与处理 R1002
数据采集模块-手机信息汇聚与发送 R1003
数据分析模块-坑位信息接收与预处理 R2001
数据分析模块-坑位信息建模与训练 R2002
数据展示模块-坑位预测信息展示  R3001
数据展示模块-城市道路坑位热力图 R3002

### 1.4 术语定义

### 1.5 参考资料

- Silva N, Soares J, Shah V, et al. Anomaly detection in roads with a data mining approach[J]. Procedia computer science, 2017, 121: 415-422.
- Ke J, Qin X, Yang H, et al. Predicting origin-destination ride-sourcing demand with a spatio-temporal encoder-decoder residual multi-graph convolutional network[J]. arXiv preprint arXiv:1910.09103, 2019.
- Geng X, Li Y, Wang L, et al. Spatiotemporal multi-graph convolution network for ride-hailing demand forecasting[C]//2019 AAAI Conference on Artificial Intelligence (AAAI’19). 2019.
- Chu K F, Lam A Y S, Li V O K. Travel Demand Prediction using Deep Multi-Scale Convolutional LSTM Network[C]//2018 21st International Conference on Intelligent Transportation Systems (ITSC). IEEE, 2018: 1402-1407.
- Chu K F, Lam A Y S, Li V O K. Deep multi-scale convolutional LSTM network for travel demand and origin-destination predictions[J]. IEEE Transactions on Intelligent Transportation Systems, 2019.

## 2. 需求概述

### 2.1 目标

本文描述的基于传感器的城市道路状况检测，利用数据挖掘，数据分析，信号处理，机器学习等相关的技术对手机上的传感器的数据进行分析，反馈最近一段时间内道路路面状况信息并对坑位进行预测。最后对结果进行数据可视化的展示。

### 2.2 范围

本项目范围只包含下文提到的各个子系统/功能模块的软件开发、部署、维护以及相关培训。

### 2.3 用户的特点

本系统的最终用户为政府交通部门，以更加快捷高效的方式帮助部门实现路面坑洞检测。

### 2.4 假设和依赖

列出本项目的假设和依赖关系，如准备条件、开发周期限制等。

**假设**

| 序号   | 假设                                             | 现实                                                   |
| ------ | ------------------------------------------------ | ------------------------------------------------------ |
| 假设一 | 本系统所存在的网络环境是绝对安全的，不遭受到攻击 | 互联网上存在着大量攻击，系统在网络中存在大量风险       |
| 假设二 | 系统各模块功能正常                               | 运行中，各模块运行可能出现异常                         |
| 假设三 | 网络传输不会丢失数据，延时为0                    | 网络环境十分复杂，4G网络延时达到几十毫秒，数据有丢失。 |
| 假设四 | 国内新冠疫情不会第二次爆发                       | 暂时只有小规模个数的感染                               |
| 假设五 | 手机传感器定位精准                               | Gpu信号不太稳定，不同手机传感器精度不同                |

**依赖**
| 序号   | 内容                                                                                                         |
| ------ | ------------------------------------------------------------------------------------------------------------ |
| 假设一 | 本系统数据处理和建模预测等过程都需要先进行数据采集过程，即数据采集与数据处理与建模过程之间存在数据依赖       |
| 假设二 | 本系统可视化模块需要来自数据采集与建模分析的数据，即可视化模块与数据采集存在数据依赖，与建模分析存在功能依赖 |

## 3. 功能需求

项目整体功能主要分为4个模块，10个子功能

![](https://imgbed.momodel.cn/20201209185250.png)

### 3.1 数据采集模块

该模块主要用于训练模型阶段的数据采集工作。

#### 3.1.1 传感器数据收集

该模块负责调用手机上的传感器收集数据，在开发环境下将会调用一个摄像头设备，利用该设备帮助开发人员开发和调试程序。

##### 3.1.1.1 

![](https://imgbed.momodel.cn/20201209185711.png)

业务流程：

1. 用户打开配置模块
2. 开启手机传感器进行收据手机，如若是在开发环境下，则打开摄像头与汽车轮胎上的摄像头进行蓝牙连接
3. 在开发环境下，若用户观察摄像头采集的画面是否存在延迟，如果有延迟则调整摄像头，正常则结束。

#### 3.1.2 数据采集模块

用户通过数据采集模块采集、标注数据(开发环境下)，并上传至服务端，后期由服务端训练模型

##### 3.1.1.2业务 流程

![](https://imgbed.momodel.cn/20201209185735.png)

业务流程：

1. 用户启动模块
2. 用户启动采集设备
3. 用户停止采集，这期间采集到的数据在手机端显示
4. 用户标注数据(开发环境下)
5. 用户根据是否在无线网环境下判断是否直接上传数据至服务器，是则直接上传，否则现在本地存储。

### 3.2 数据处理模块

#### 3.2.1 数据预处理模块

该模块主要用于对手机端所收集得到的原始信号数据开展一系列数据预处理工作，以确保上传至服务器端的数据达到数据分析的相关使用要求。

##### 3.2.1.1 业务流程

![](https://imgbed.momodel.cn/20201209185754.png)

流程描述：

手机端采集得到的原始数据需要依次进行以下四个数据预处理环节。

1. 重采样：解决手机端传感器采样频率不稳定的问题
2. 重定向：考虑到手机是被随意放置的，因此需要通过坐标系转换将信号数据转换到汽车坐标系下
3. 信号滤波：通过滤波器对所采集的信号数据中包含的一些噪声进行过滤
4. 数据切分：考虑连续信号不利于后期的数据分析，因此采用滑动窗口机制将信号分割成一系列样本片段
经过预处理阶段后的数据将从手机端上传至服务端

#### 3.2.2 数据上传模块

作为手机端的一个功能模块，其主要负责在指定条件下将经过预处理后的数据上传至服务器端。

##### 3.2.2.1 业务流程

![](https://imgbed.momodel.cn/20201209185811.png)

流程描述：

数据上传模块主要分为模型生成的预训练阶段和模型应用的日常使用阶段这两种情况
对于日常使用阶段，考虑到采集的数据量较小，因此，数据上传任务可以直接使用数据流量在手机后台自动进行。
对于模型预训练阶段，由于模型训练需要集中性的采集大量数据，因此用户可以在WIFI环境下，对采集到的数据以单个上传或批量上传的模式进行上传。其数据上传简要运行流程如下所示。

1. 在WIFI条件下，用户首先需要选择单个上传或批量上传模式。
2. 模式选择完成后，用户需要选取指定的数据并点击上传。
3. 服务器端数据接收模块将根据处理结果返回相应的处理信息，并在手机端可视化。

#### 3.2.3 数据接收模块

作为服务器端的一个功能模块，负责对上传数据的客户端进行身份认证，接收和存储认证成功客户端所上传的数据，并具备对上述环节设置条件控制的权限。

##### 3.2.3.1 业务流程

![](https://imgbed.momodel.cn/20201209185826.png)
流程描述：

1. 对于手机客户端所上传的数据，服务器端的数据接收模块首先会对从手机端同时上传而来的用户身份凭证进行验证，若非系统所认可的用户，则向手机端发送异常信息并结束进程；否则，继续下列操作。
2. 检查客户端单次上传的数据量是否超过系统设置最大值，若超过最大值，则对数据进行裁剪操作。
3. 对数据进行规范检查，包括数据格式等。对于不符合数据标准的数据，向手机端返回异常信息并结束进程；否则，继续下列操作。
4. 将数据存储至数据库中，并向手机客户端返回接收成功的提示信息。

### 3.3 数据分析模块

#### 3.3.1 数据分析模块

该模块主要用于对手机端发送的数据进行分析，将检测后的道路信息添加至数据。

##### 3.3.1.1 业务流程

![](https://imgbed.momodel.cn/20201209185841.png)
流程描述：

1. 从数据库提取手机端预处理完的加速度计、GPS、时间戳、视频数据(开发环境下)等数据
2. 对数据进行信号转换、体征提取
3. 通过模型进行数据分析得到路况信息
4. 将路况信息添加至数据库

### 3.4 道路状况展示模块

#### 3.4.1 坑洞信息展示

用户通过手机端的道路信息展示模块可从服务端获取当前位置附近的道路状况信息。

##### 3.4.1.1 业务流程

![](https://imgbed.momodel.cn/20201209185858.png)
业务流程描述：

1. 用户启动道路状况展示模块
2. 手机端请求城市地图信息，服务端响应请求并返回信息
3. 手机端周期性从服务端获取附近道路状况信息
4. 根据获得的道路信息，标注周围的坑洞为热力点
5. 随着位置移动，删除与当前位置距离较远的标注点

#### 3.4.2 当前位置展示

在城市地图上显示用户当前位置

##### 3.4.2.1 业务流程

![](https://imgbed.momodel.cn/20201209185922.png)
业务流程描述：

1. 用户启动道路状况展示模块
2. 手机端请求城市地图信息，服务端响应请求并返回信息
3. 在城市地图上周期性的更新当前位置

## 4 非功能需求

### 4.1 界面需求

为实现系统功能，需包括如下界面：

- 安卓App数据汇总界面。
- 道路坑口预测展示界面。
- 城市区域地图坑位热点图。

### 4.2 性能需求

- 在100名用户并发使用的情况下，后端收集数据服务能正常运行，不会停止服务。
- 道路坑位预测时间 <= 1ms。

### 4.3 运行环境需求

本系统由模型、后台服务、Android客户端3个部分组成，说明如下：

- 模型需要一台GPU高性能服务器进行计算，快速训练模型。
- 后台服务高网络带宽的高性能服务器，保证数据流量不会因为网路阻塞，同时配有大容量存储，存储流数据。
- 主流的安卓手机，运行Android客户端即可。

### 4.4 安全性需求

用户上传数据需要：

- 信息的加密传输。
- 有效用户鉴定。

### 4.5 质量需求

- 系统正常情况下保持7x24高可用。
- 后端按需求实现扩缩容。
- 坑位预测准确率到达90%以上。

### 4.6 其它需求

提供完整的系统使用说明手册，安装部署文档。

## 其他

### 系统初步设计

#### 道路检测客户端

![](https://imgbed.momodel.cn/%E9%81%93%E5%85%B7%E6%A3%80%E6%B5%8B%E5%AE%A2%E6%88%B7%E7%AB%AFapp.jpg)

#### 道路检测服务端

![](https://imgbed.momodel.cn/%E9%81%93%E8%B7%AF%E6%A3%80%E6%B5%8B%E6%9C%8D%E5%8A%A1%E7%AB%AF.jpg)